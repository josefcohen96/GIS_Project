<!DOCTYPE html>
<html>

<head>
	<title>Party Locations</title>
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
	<style>
		html,


		#map {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			z-index: 0;
		}

		#mapWindow {
			position: absolute;
			top: 100px;
			/* Adjust the top position as needed */
			left: 10px;
			/* Adjust the left position as needed */
			z-index: 1;
			background-color: #fff;
			padding: 10px;
			border-radius: 5px;
		}
	</style>
</head>

<body>
	<div id="map"></div>
	<div id="mapWindow">
		<div id="menu">
			<h3>Search Events</h3>
			<select id="monthSelect">
				<option value="">All Months</option>
				<option value="01">January</option>
				<option value="02">February</option>
				<option value="03">March</option>
				<option value="04">April</option>
				<option value="05">May</option>
				<option value="06">June</option>
				<option value="07">July</option>
				<option value="08">August</option>
				<option value="09">September</option>
				<option value="10">October</option>
				<option value="11">November</option>
				<option value="12">December</option>
			</select>
			<button onclick="searchEvents()">Search</button>
		</div>
	</div>


	<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
	<script>
		const parties =
			[
				{
					"name": "Party 1",
					"coordinates": {
						"latitude": 36.5200,
						"longitude": 8.4050
					},
					"start_time": "2023-01-05 19:00",
					"end_time": "2023-01-06 01:00",
					"date": "2023-01-05"
				},
				{
					"name": "Party 2",
					"coordinates": {
						"latitude": 34.0522,
						"longitude": 118.2437
					},
					"start_time": "2023-02-14 20:00",
					"end_time": "2023-02-15 02:00",
					"date": "2023-02-14"
				},
				{
					"name": "Party 3",
					"coordinates": {
						"latitude": 51.5074,
						"longitude": 0.1278
					},
					"start_time": "2023-03-22 21:00",
					"end_time": "2023-03-23 03:00",
					"date": "2023-03-22"
				},
				{
					"name": "Party 4",
					"coordinates": {
						"latitude": 37.7749,
						"longitude": 122.4194
					},
					"start_time": "2023-04-07 18:00",
					"end_time": "2023-04-08 00:00",
					"date": "2023-04-07"
				},
				{
					"name": "Party 5",
					"coordinates": {
						"latitude": 51.5074,
						"longitude": 0.1278
					},
					"start_time": "2023-05-10 22:00",
					"end_time": "2023-05-11 04:00",
					"date": "2023-05-10"
				},
				{
					"name": "Party 6",
					"coordinates": {
						"latitude": 40.7128,
						"longitude": 74.0060
					},
					"start_time": "2023-06-18 19:30",
					"end_time": "2023-06-19 01:30",
					"date": "2023-06-18"
				},
				{
					"name": "Party 7",
					"coordinates": {
						"latitude": 34.0522,
						"longitude": 118.2437
					},
					"start_time": "2023-07-25 20:30",
					"end_time": "2023-07-26 02:30",
					"date": "2023-07-25"
				},
				{
					"name": "Party 8",
					"coordinates": {
						"latitude": 37.7749,
						"longitude": 122.4194
					},
					"start_time": "2023-08-08 17:30",
					"end_time": "2023-08-09 00:30",
					"date": "2023-08-08"
				},
				{
					"name": "Party 9",
					"coordinates": {
						"latitude": 51.5074,
						"longitude": -0.1278
					},
					"start_time": "2023-09-14 21:00",
					"end_time": "2023-08-09 00:30",
					"date": "2023-08-08"
				},
				{
					"name": "Party 10",
					"coordinates": {
						"latitude": 52.5200,
						"longitude": 13.4050
					},
					"start_time": "2023-10-11 18:00",
					"end_time": "2023-10-12 02:00",
					"date": "2023-10-11"
				},
				{
					"name": "Party 11",
					"coordinates": {
						"latitude": 48.8566,
						"longitude": 2.3522
					},
					"start_time": "2023-11-13 21:00",
					"end_time": "2023-11-14 03:00",
					"date": "2023-11-13"
				},
				{
					"name": "Party 12",
					"coordinates": {
						"latitude": 37.7749,
						"longitude": -122.4194
					},
					"start_time": "2023-12-10 20:00",
					"end_time": "2023-12-11 02:00",
					"date": "2023-12-10"
				},
				{
					"name": "Party 13",
					"coordinates": {
						"latitude": 51.5074,
						"longitude": -0.1278
					},
					"start_time": "2024-01-12 19:30",
					"end_time": "2024-01-13 01:30",
					"date": "2024-01-12"
				},
				{
					"name": "Party 14",
					"coordinates": {
						"latitude": 34.0522,
						"longitude": -118.2437
					},
					"start_time": "2024-02-14 20:30",
					"end_time": "2024-02-15 02:30",
					"date": "2024-02-14"
				},
				{
					"name": "Party 15",
					"coordinates": {
						"latitude": 40.7128,
						"longitude": -74.0060
					},
					"start_time": "2024-03-10 18:30",
					"end_time": "2024-03-11 00:30",
					"date": "2024-03-10"
				},
				{
					"name": "Party 16",
					"coordinates": {
						"latitude": 51.5074,
						"longitude": -0.1278
					},
					"start_time": "2024-04-15 21:00",
					"end_time": "2024-04-16 03:00",
					"date": "2024-04-15"
				},
				{
					"name": "Party 17",
					"coordinates": {
						"latitude": 34.0522,
						"longitude": -118.2437
					},
					"start_time": "2024-05-12 20:00",
					"end_time": "2024-05-13 02:00",
					"date": "2024-05-12"
				},
				{
					"name": "Party 18",
					"coordinates": {
						"latitude": 37.7749,
						"longitude": -122.4194
					},
					"start_time": "2024-06-22 19:30",
					"end_time": "2024-06-23 01:30",
					"date": "2024-06-22"
				},
				{
					"name": "Party 19",
					"coordinates": {
						"latitude": 48.8566,
						"longitude": 2.3522
					},
					"start_time": "2024-07-19 20:30",
					"end_time": "2024-07-20 02:30",
					"date": "2024-07-19"
				},
				{
					"name": "Party A",
					"coordinates": {
						"latitude": 48.8566,
						"longitude": 2.3522
					},
					"start_time": "2023-08-05T21:00:00Z",
					"end_time": "2023-08-06T03:00:00Z",
					"date": "2023-08-05"
				},
				{
					"name": "Party B",
					"coordinates": {
						"latitude": 41.9028,
						"longitude": 12.4964
					},
					"start_time": "2023-08-10T22:00:00Z",
					"end_time": "2023-08-11T04:00:00Z",
					"date": "2023-08-10"
				},
				{
					"name": "Party C",
					"coordinates": {
						"latitude": 43.7034,
						"longitude": 7.2663
					},
					"start_time": "2023-08-15T20:30:00Z",
					"end_time": "2023-08-16T02:30:00Z",
					"date": "2023-08-15"
				},
				{
					"name": "Party D",
					"coordinates": {
						"latitude": 41.9028,
						"longitude": 12.4964
					},
					"start_time": "2023-11-03T23:00:00Z",
					"end_time": "2023-11-04T05:00:00Z",
					"date": "2023-11-03"
				},
				{
					"name": "Party E",
					"coordinates": {
						"latitude": 43.7034,
						"longitude": 7.2663
					},
					"start_time": "2023-11-08T21:30:00Z",
					"end_time": "2023-11-09T03:30:00Z",
					"date": "2023-11-08"
				}, {
					"name": "Party F",
					"coordinates": {
						"latitude": -26.2041,
						"longitude": 28.0473
					},
					"start_time": "2023-10-07T19:00:00Z",
					"end_time": "2023-10-08T02:00:00Z",
					"date": "2023-10-07"
				},
				{
					"name": "Party G",
					"coordinates": {
						"latitude": -33.9249,
						"longitude": 18.4241
					},
					"start_time": "2023-10-14T21:00:00Z",
					"end_time": "2023-10-15T03:00:00Z",
					"date": "2023-10-14"
				},
				{
					"name": "Party H",
					"coordinates": {
						"latitude": -1.2921,
						"longitude": 36.8219
					},
					"start_time": "2023-12-02T22:30:00Z",
					"end_time": "2023-12-03T04:30:00Z",
					"date": "2023-12-02"
				},
				{
					"name": "Party I",
					"coordinates": {
						"latitude": -26.2041,
						"longitude": 28.0473
					},
					"start_time": "2023-12-09T20:00:00Z",
					"end_time": "2023-12-10T02:00:00Z",
					"date": "2023-12-09"
				},
				{
					"name": "Party J",
					"coordinates": {
						"latitude": -33.9249,
						"longitude": 18.4241
					},
					"start_time": "2023-12-16T22:00:00Z",
					"end_time": "2023-12-17T04:00:00Z",
					"date": "2023-12-16"
				},
				{
					"name": "Party K",
					"coordinates": {
						"latitude": -23.5505,
						"longitude": -46.6333
					},
					"start_time": "2023-06-05T22:00:00Z",
					"end_time": "2023-06-06T04:00:00Z",
					"date": "2023-06-05"
				},
				{
					"name": "Party L",
					"coordinates": {
						"latitude": -33.4489,
						"longitude": -70.6693
					},
					"start_time": "2023-06-15T21:30:00Z",
					"end_time": "2023-06-16T03:30:00Z",
					"date": "2023-06-15"
				},
				{
					"name": "Party M",
					"coordinates": {
						"latitude": 45.4215,
						"longitude": -75.6972
					},
					"start_time": "2023-07-10T20:00:00Z",
					"end_time": "2023-07-11T02:00:00Z",
					"date": "2023-07-10"
				},
				{
					"name": "Party N",
					"coordinates": {
						"latitude": -12.0464,
						"longitude": -77.0428
					},
					"start_time": "2023-08-18T22:30:00Z",
					"end_time": "2023-08-19T04:30:00Z",
					"date": "2023-08-18"
				},
				{
					"name": "Party O",
					"coordinates": {
						"latitude": 43.6511,
						"longitude": -79.3832
					},
					"start_time": "2023-09-25T19:00:00Z",
					"end_time": "2023-09-26T01:00:00Z",
					"date": "2023-09-25"
				}
			]


		let map;
		let markersLayer;

		function displayPartyLocations(parties) {
			if (markersLayer) {
				markersLayer.clearLayers();
			}

			parties.forEach(party => {
				const marker = L.marker([party.coordinates.latitude, party.coordinates.longitude]).addTo(map);
				const startTime = new Date(party.start_time).toLocaleTimeString([], { timeStyle: 'short' });
				const endTime = new Date(party.end_time).toLocaleTimeString([], { timeStyle: 'short' });

				marker.bindPopup(`<b>${party.name}</b><br>${party.date}<br>${startTime} - ${endTime}`);
				marker.on('click', () => {
					map.setView(marker.getLatLng(), 8);
					marker.openPopup();
				});
			});
		}

		function initMap() {
			map = L.map('map').setView([0, 0], 2);
			markersLayer = L.layerGroup().addTo(map);

			const streetTileLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
				attribution: 'Map data Â© <a href="https://openstreetmap.org">OpenStreetMap</a> contributors',
				maxZoom: 18
			});

			const satelliteTileLayer = L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
				attribution: 'Map data Â© <a href="https://opentopomap.org">OpenTopoMap</a> contributors',
				maxZoom: 18
			});



			const baseLayers = {
				"Street": streetTileLayer,
				"Satellite": satelliteTileLayer,
			};

			streetTileLayer.addTo(map);
			L.control.layers(baseLayers).addTo(map);

			displayPartyLocations(parties);
		}

		function searchEvents() {
			let selectedMonth = document.getElementById('monthSelect').value;
			let filteredParties;

			if (selectedMonth) {
				filteredParties = parties.filter(party => {
					const date = new Date(party.date);
					const month = date.getMonth() + 1; // Adding 1 because getMonth() returns zero-based index
					return month === parseInt(selectedMonth);
				});
			} else {
				filteredParties = parties;
			}

			// Remove previous markers
			map.eachLayer(layer => {
				if (layer instanceof L.Marker) {
					map.removeLayer(layer);
				}
			});

			// Add markers for filtered parties
			filteredParties.forEach(party => {
				let marker = L.marker([party.coordinates.latitude, party.coordinates.longitude]).addTo(map);
				const startTime = new Date(party.start_time).toLocaleTimeString([], { timeStyle: 'short' });
				const endTime = new Date(party.end_time).toLocaleTimeString([], { timeStyle: 'short' });

				marker.bindPopup(`<b>${party.name}</b><br>${party.date}<br>${startTime} - ${endTime}`);
			});
		}

		document.addEventListener('DOMContentLoaded', () => {
			initMap();
			searchEvents();
			monthSelect.addEventListener('change', searchEvents);
		});
	</script>
</body>

</html>