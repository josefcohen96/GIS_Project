<!DOCTYPE html>
<html>

<head>
	<title>Party Locations</title>
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
	<style>
		html,


		#map {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			z-index: 0;
		}

		#mapWindow {
			position: absolute;
			top: 100px;
			/* Adjust the top position as needed */
			left: 10px;
			/* Adjust the left position as needed */
			z-index: 1;
			background-color: #fff;
			padding: 10px;
			border-radius: 5px;
		}

		.marker-icon {
			width: 25px;
			height: 41px;
			margin-top: -20px;
			margin-left: -12px;
		}

		.red {
			background-color: red;
		}

		.blue {
			background-color: blue;
		}
	</style>
</head>

<body>
	<div id="map"></div>
	<div id="mapWindow">
		<div id="menu">
			<h3>Search Events</h3>
			<select id="monthSelect">
				<option value="">All Months</option>
				<option value="01">January</option>
				<option value="02">February</option>
				<option value="03">March</option>
				<option value="04">April</option>
				<option value="05">May</option>
				<option value="06">June</option>
				<option value="07">July</option>
				<option value="08">August</option>
				<option value="09">September</option>
				<option value="10">October</option>
				<option value="11">November</option>
				<option value="12">December</option>
			</select>
			<button onclick="searchByMonth()">Search</button>
		</div>
	</div>


	<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
	<script>
		const parties =
			[
				{
					"name": "Party 1",
					"coordinates": {
						"latitude": 36.5200,
						"longitude": 8.4050
					},
					"start_time": "2023-01-05 19:00",
					"end_time": "2023-03-05 01:00",
					"date": "2023-01-05",
					"marker": null
				},
				{
					"name": "Party 2",
					"coordinates": {
						"latitude": 34.0522,
						"longitude": 118.2437
					},
					"start_time": "2023-02-14 20:00",
					"end_time": "2023-02-15 02:00",
					"date": "2023-02-14",
					"marker": null
				},
				{
					"name": "Party 3",
					"coordinates": {
						"latitude": 51.5074,
						"longitude": 0.1278
					},
					"start_time": "2023-03-22 21:00",
					"end_time": "2023-03-23 03:00",
					"date": "2023-03-22",
					"marker": null
				},
				{
					"name": "Party 4",
					"coordinates": {
						"latitude": 37.7749,
						"longitude": 122.4194
					},
					"start_time": "2023-04-07 18:00",
					"end_time": "2023-04-08 00:00",
					"date": "2023-04-07",
					"marker": null
				},
				{
					"name": "Party 5",
					"coordinates": {
						"latitude": 51.5074,
						"longitude": 0.1278
					},
					"start_time": "2023-05-10 22:00",
					"end_time": "2023-05-11 04:00",
					"date": "2023-05-10",
					"marker": null
				},
				{
					"name": "Party 6",
					"coordinates": {
						"latitude": 40.7128,
						"longitude": 74.0060
					},
					"start_time": "2023-06-18 19:30",
					"end_time": "2023-06-19 01:30",
					"date": "2023-06-18",
					"marker": null
				},
				{
					"name": "Party 7",
					"coordinates": {
						"latitude": 34.0522,
						"longitude": 118.2437
					},
					"start_time": "2023-07-25 20:30",
					"end_time": "2023-07-26 02:30",
					"date": "2023-07-25",
					"marker": null
				},
				{
					"name": "Party 8",
					"coordinates": {
						"latitude": 37.7749,
						"longitude": 122.4194
					},
					"start_time": "2023-08-08 17:30",
					"end_time": "2023-08-09 00:30",
					"date": "2023-08-08",
					"marker": null
				},
				{
					"name": "Party 9",
					"coordinates": {
						"latitude": 51.5074,
						"longitude": -0.1278
					},
					"start_time": "2023-09-14 21:00",
					"end_time": "2023-08-09 00:30",
					"date": "2023-08-08",
					"marker": null
				},
				{
					"name": "Party 10",
					"coordinates": {
						"latitude": 52.5200,
						"longitude": 13.4050
					},
					"start_time": "2023-10-11 18:00",
					"end_time": "2023-10-12 02:00",
					"date": "2023-10-11",
					"marker": null
				},
				{
					"name": "Party 11",
					"coordinates": {
						"latitude": 48.8566,
						"longitude": 2.3522
					},
					"start_time": "2023-11-13 21:00",
					"end_time": "2023-11-14 03:00",
					"date": "2023-11-13",
					"marker": null
				},
				{
					"name": "Party 12",
					"coordinates": {
						"latitude": 37.7749,
						"longitude": -122.4194
					},
					"start_time": "2023-12-10 20:00",
					"end_time": "2023-12-11 02:00",
					"date": "2023-12-10",
					"marker": null
				},
				{
					"name": "Party 13",
					"coordinates": {
						"latitude": 51.5074,
						"longitude": -0.1278
					},
					"start_time": "2024-01-12 19:30",
					"end_time": "2024-01-13 01:30",
					"date": "2024-01-12",
					"marker": null
				},
				{
					"name": "Party 14",
					"coordinates": {
						"latitude": 34.0522,
						"longitude": -118.2437
					},
					"start_time": "2024-02-14 20:30",
					"end_time": "2024-02-15 02:30",
					"date": "2024-02-14",
					"marker": null
				},
				{
					"name": "Party 15",
					"coordinates": {
						"latitude": 40.7128,
						"longitude": -74.0060
					},
					"start_time": "2024-03-10 18:30",
					"end_time": "2024-03-11 00:30",
					"date": "2024-03-10",
					"marker": null
				},
				{
					"name": "Party 16",
					"coordinates": {
						"latitude": 51.5074,
						"longitude": -0.1278
					},
					"start_time": "2024-04-15 21:00",
					"end_time": "2024-04-16 03:00",
					"date": "2024-04-15",
					"marker": null
				},
				{
					"name": "Party 17",
					"coordinates": {
						"latitude": 34.0522,
						"longitude": -118.2437
					},
					"start_time": "2024-05-12 20:00",
					"end_time": "2024-05-13 02:00",
					"date": "2024-05-12",
					"marker": null
				},
				{
					"name": "Party 18",
					"coordinates": {
						"latitude": 37.7749,
						"longitude": -122.4194
					},
					"start_time": "2024-06-22 19:30",
					"end_time": "2024-06-23 01:30",
					"date": "2024-06-22",
					"marker": null
				},
				{
					"name": "Party 19",
					"coordinates": {
						"latitude": 48.8566,
						"longitude": 2.3522
					},
					"start_time": "2024-07-19 20:30",
					"end_time": "2024-07-20 02:30",
					"date": "2024-07-19",
					"marker": null
				},
				{
					"name": "Party A",
					"coordinates": {
						"latitude": 48.8566,
						"longitude": 2.3522
					},
					"start_time": "2023-08-05T21:00:00Z",
					"end_time": "2023-08-06T03:00:00Z",
					"date": "2023-08-05",
					"marker": null
				},
				{
					"name": "Party B",
					"coordinates": {
						"latitude": 41.9028,
						"longitude": 12.4964
					},
					"start_time": "2023-08-10T22:00:00Z",
					"end_time": "2023-08-11T04:00:00Z",
					"date": "2023-08-10",
					"marker": null
				},
				{
					"name": "Party C",
					"coordinates": {
						"latitude": 43.7034,
						"longitude": 7.2663
					},
					"start_time": "2023-08-15T20:30:00Z",
					"end_time": "2023-08-16T02:30:00Z",
					"date": "2023-08-15",
					"marker": null
				},
				{
					"name": "Party D",
					"coordinates": {
						"latitude": 41.9028,
						"longitude": 12.4964
					},
					"start_time": "2023-11-03T23:00:00Z",
					"end_time": "2023-11-04T05:00:00Z",
					"date": "2023-11-03",
					"marker": null
				},
				{
					"name": "Party E",
					"coordinates": {
						"latitude": 43.7034,
						"longitude": 7.2663
					},
					"start_time": "2023-11-08T21:30:00Z",
					"end_time": "2023-11-09T03:30:00Z",
					"date": "2023-11-08",
					"marker": null
				}, {
					"name": "Party F",
					"coordinates": {
						"latitude": -26.2041,
						"longitude": 28.0473
					},
					"start_time": "2023-10-07T19:00:00Z",
					"end_time": "2023-10-08T02:00:00Z",
					"date": "2023-10-07",
					"marker": null
				},
				{
					"name": "Party G",
					"coordinates": {
						"latitude": -33.9249,
						"longitude": 18.4241
					},
					"start_time": "2023-10-14T21:00:00Z",
					"end_time": "2023-10-15T03:00:00Z",
					"date": "2023-10-14",
					"marker": null
				},
				{
					"name": "Party H",
					"coordinates": {
						"latitude": -1.2921,
						"longitude": 36.8219
					},
					"start_time": "2023-12-02T22:30:00Z",
					"end_time": "2023-12-03T04:30:00Z",
					"date": "2023-12-02",
					"marker": null
				},
				{
					"name": "Party I",
					"coordinates": {
						"latitude": -26.2041,
						"longitude": 28.0473
					},
					"start_time": "2023-12-09T20:00:00Z",
					"end_time": "2023-12-10T02:00:00Z",
					"date": "2023-12-09",
					"marker": null
				},
				{
					"name": "Party J",
					"coordinates": {
						"latitude": -33.9249,
						"longitude": 18.4241
					},
					"start_time": "2023-12-16T22:00:00Z",
					"end_time": "2023-12-17T04:00:00Z",
					"date": "2023-12-16",
					"marker": null
				},
				{
					"name": "Party K",
					"coordinates": {
						"latitude": -23.5505,
						"longitude": -46.6333
					},
					"start_time": "2023-06-05T22:00:00Z",
					"end_time": "2023-06-06T04:00:00Z",
					"date": "2023-06-05",
					"marker": null
				},
				{
					"name": "Party L",
					"coordinates": {
						"latitude": -33.4489,
						"longitude": -70.6693
					},
					"start_time": "2023-06-15T21:30:00Z",
					"end_time": "2023-06-16T03:30:00Z",
					"date": "2023-06-15",
					"marker": null
				},
				{
					"name": "Party M",
					"coordinates": {
						"latitude": 45.4215,
						"longitude": -75.6972
					},
					"start_time": "2023-07-10T20:00:00Z",
					"end_time": "2023-07-11T02:00:00Z",
					"date": "2023-07-10",
					"marker": null
				},
				{
					"name": "Party N",
					"coordinates": {
						"latitude": -12.0464,
						"longitude": -77.0428
					},
					"start_time": "2023-08-18T22:30:00Z",
					"end_time": "2023-08-19T04:30:00Z",
					"date": "2023-08-18",
					"marker": null
				},
				{
					"name": "Party O",
					"coordinates": {
						"latitude": 43.6511,
						"longitude": -79.3832
					},
					"start_time": "2023-09-25T19:00:00Z",
					"end_time": "2023-09-26T01:00:00Z",
					"date": "2023-09-25",
					"marker": null
				}
			]


		function createMarkers() {
			parties.forEach(party => {
				const marker = L.marker([party.coordinates.latitude, party.coordinates.longitude], {
					icon: L.icon({
						iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png',
						iconSize: [25, 41],
						iconAnchor: [12, 41],
						popupAnchor: [1, -34],
						shadowSize: [41, 41]
					})
				});

				const duration = (new Date(party.end_time) - new Date(party.start_time)) / 3600000; // Duration in hours
				const color = getColor(duration);

				party.marker = marker; // Assign the marker to the party object

				marker.addTo(map)
					.bindPopup(`<b>${party.name}</b><br>${party.start_time} - ${party.end_time}`)
					.setIcon(L.icon({
						iconUrl: `https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-${color}.png`,
						iconSize: [25, 41],
						iconAnchor: [12, 41],
						popupAnchor: [1, -34],
						shadowSize: [41, 41]
					}));
			});
		}

		function getColor(duration) {
			if (duration <= 6) {
				return 'green';
			} else if (duration <= 9) {
				return 'orange';
			} else {
				return 'red';
			}
		}

		function clearMarkers() {
			parties.forEach(party => {
				if (party.marker) {
					party.marker.removeFrom(map); // Remove the marker from the map
				}
			});
		}

		function searchByMonth() {
			var selectedMonth = document.getElementById("monthSelect").value;
			var filteredParties = [];

			if (selectedMonth === "") {
				filteredParties = parties;
			} else {
				filteredParties = parties.filter(function (party) {
					var partyMonth = party.date.slice(5, 7);
					return partyMonth === selectedMonth;
				});
			}
			clearMarkers();
			// Call a function to display the filtered parties on the map

			displayParties(filteredParties);
		}

		function displayParties(parties) {
			clearMarkers();

			// Remove existing markers from the map
			parties.forEach(function (party) {
				if (party.marker) {
					map.removeLayer(party.marker);
				}
			});

			// Add markers for the filtered parties on the map
			parties.forEach(party => {
				const marker = L.marker([party.coordinates.latitude, party.coordinates.longitude], {
					icon: L.icon({
						iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png',
						iconSize: [25, 41],
						iconAnchor: [12, 41],
						popupAnchor: [1, -34],
						shadowSize: [41, 41]
					})
				});

				const duration = (new Date(party.end_time) - new Date(party.start_time)) / 3600000; // Duration in hours
				const color = getColor(duration);

				party.marker = marker; // Assign the marker to the party object

				marker.addTo(map)
					.bindPopup(`<b>${party.name}</b><br>${party.start_time} - ${party.end_time}`)
					.setIcon(L.icon({
						iconUrl: `https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-${color}.png`,
						iconSize: [25, 41],
						iconAnchor: [12, 41],
						popupAnchor: [1, -34],
						shadowSize: [41, 41]
					}));
			});
		}

		// Initialize the map
		const map = L.map('map').setView([37.7749, -122.4194], 13);
		L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
			attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors',
			maxZoom: 18
		}).addTo(map);

		createMarkers();
	</script>
</body>

</html>